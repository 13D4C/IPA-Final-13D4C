---
- name: Backup running config
  hosts: routers
  gather_facts: false
  connection: network_cli

  tasks:
    - name: Show running-config
      cisco.ios.ios_command:
        commands:
          - show running-config
      register: config

    - name: Save config to file
      copy:
        content: "{{ config.stdout[0] }}"
        dest: "./show_run_{{ student_id }}_{{ inventory_hostname }}.txt"
      delegate_to: localhost